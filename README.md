Portion of the code shared with Freelancer.

These are the 3 classes that do most of the work and need to be optimized.
